# ============================================================
# Security Headers - Mozilla Observatory A+ Target
# Created: $(date -I) by Nova/TriForce
# ============================================================

<IfModule mod_headers.c>
    # === CSP (Content Security Policy) - ENFORCED ===
    # Angepasst f√ºr WordPress + API
    Header always set Content-Security-Policy "\
        default-src 'self'; \
        script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; \
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; \
        img-src 'self' data: https: blob:; \
        font-src 'self' https://fonts.gstatic.com data:; \
        connect-src 'self' wss: https:; \
        frame-ancestors 'none'; \
        base-uri 'self'; \
        form-action 'self'; \
        upgrade-insecure-requests"

    # === HSTS (1 Jahr + Subdomains + Preload) ===
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

    # === Clickjacking Protection ===
    Header always set X-Frame-Options "DENY"

    # === MIME Sniffing Protection ===
    Header always set X-Content-Type-Options "nosniff"

    # === Referrer Policy ===
    Header always set Referrer-Policy "strict-origin-when-cross-origin"

    # === Permissions Policy (Feature Policy) ===
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=()"

    # === Cross-Origin Policies ===
    Header always set Cross-Origin-Opener-Policy "same-origin"
    Header always set Cross-Origin-Embedder-Policy "unsafe-none"
    Header always set Cross-Origin-Resource-Policy "same-origin"

    # === Remove Server Version Info ===
    Header always unset X-Powered-By
    Header always unset Server
</IfModule>
